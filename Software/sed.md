你想了解的 `sed` 是 Linux/Unix 系统中**最常用的文本处理工具之一**，全称是 **Stream Editor（流编辑器）**，核心作用是**对文本流进行批量的查找、替换、删除、插入**等操作，它处理文本时不会交互式编辑，而是按预设规则逐行处理输入的文本流（文件、管道输出、标准输入等），非常适合脚本编写、批量修改配置文件、日志处理等场景。

简单来说：`sed` 是**非交互式、行导向**的文本处理神器，轻量且执行效率高，是 Linux 运维、Shell 脚本开发的必备工具。

### 一、sed 的核心特点
1. **流处理**：把输入文本当作**一行一行的数据流**，逐行读取、处理、输出，不会默认修改原文件（需手动指定才会覆盖）；
2. **非交互式**：执行前需指定处理规则，运行中无需人工干预，适合自动化脚本；
3. **模式匹配**：支持**正则表达式**（基础正则，部分版本支持扩展正则），能精准匹配要处理的行；
4. **原地/输出处理**：默认将处理结果输出到**标准输出（屏幕）**，加参数可实现**原地修改原文件**。

### 二、sed 的基本语法
```bash
sed [选项] '处理命令' 待处理文件
```
#### 1. 核心常用选项
| 选项 | 作用 |
|------|------|
| `-n` | 静默模式，**只输出被处理过的行**（默认会输出所有行，包括未处理的），常和 `p`（打印）命令搭配； |
| `-i` | 原地修改原文件（**最常用的修改文件选项**），Linux 中可加后缀（如 `-i.bak`）自动生成原文件备份； |
| `-e` | 执行多个处理命令，多规则拼接时使用； |
| `-r`/`-E` | 支持**扩展正则表达式**（默认是基础正则，部分特殊符号如 `+` `|` 需转义，加此选项可免转义）； |

#### 2. 核心处理命令（行操作+内容操作）
`sed` 的处理命令是核心，格式一般为 `[地址范围]操作命令`，地址范围指定要处理的行，省略则处理**所有行**，常用操作命令：

| 命令 | 作用 | 示例 |
|------|------|------|
| `s`  | 替换（substitute），**最常用**，格式 `s/旧内容/新内容/标记` | `s/hello/world/g` 全局替换行内所有hello为world |
| `d`  | 删除（delete） | `3d` 删除第3行；`/error/d` 删除包含error的行 |
| `p`  | 打印（print） | `-n '2p'` 只打印第2行；`-n '/info/p'` 只打印包含info的行 |
| `a`  | 追加（append），在匹配行**后**插入内容 | `/test/a new line` 给包含test的行后加一行new line |
| `i`  | 插入（insert），在匹配行**前**插入内容 | `5i insert line` 在第5行前插入insert line |

### 三、sed 最核心的用法：替换（s 命令）
`sed` 的替换功能是实际使用中最频繁的，格式为：
```bash
sed 's/匹配的内容/替换后的内容/标记' 文件名
```
#### 关键标记（可组合使用）
- `g`：**全局替换**（global），行内匹配到的所有内容都替换（默认只替换行内第一个匹配项）；
- `数字`：替换行内第 N 个匹配项，如 `s/ab/AB/2` 替换行内第2个ab为AB；
- `p`：打印替换后的行（常和 `-n` 搭配）；
- `w 文件名`：将替换后的行写入指定文件。

#### 替换经典示例
假设有文件 `test.txt`，内容如下：
```
hello world
hello sed, hello linux
test hello
```
1. 替换每行**第一个**`hello`为`HELLO`（默认行为，输出到屏幕，不修改原文件）：
   ```bash
   sed 's/hello/HELLO/' test.txt
   ```
   输出：
   ```
   HELLO world
   HELLO sed, hello linux
   test HELLO
   ```
2. **全局替换**所有`hello`为`HELLO`：
   ```bash
   sed 's/hello/HELLO/g' test.txt
   ```
   输出：
   ```bash
   HELLO world
   HELLO sed, HELLO linux
   test HELLO
   ```
3. **原地修改原文件**，并全局替换（生产环境建议加备份）：
   ```bash
   # 直接原地修改（无备份，谨慎使用）
   sed -i 's/hello/HELLO/g' test.txt
   # 原地修改+生成原文件备份（test.txt.bak），推荐！
   sed -i.bak 's/hello/HELLO/g' test.txt
   ```
4. 结合**正则表达式**替换：匹配以`h`开头的单词为`Hi`（基础正则）：
   ```bash
   sed 's/h\w*/Hi/g' test.txt
   ```

### 四、sed 其他常用经典用法
基于上述 `test.txt`，补充高频场景：
1. **打印指定行**：只打印第2行（`-n` 静默模式必加，否则会重复输出）
   ```bash
   sed -n '2p' test.txt
   ```
2. **删除指定行**：删除包含`sed`的行（输出到屏幕，不修改原文件）
   ```bash
   sed '/sed/d' test.txt
   ```
3. **批量删除空行**：正则匹配空行并删除（处理日志/配置文件常用）
   ```bash
   sed '/^$/d' test.txt
   ```
4. **多规则处理**：用 `-e` 组合“删除空行+全局替换hello为HELLO”
   ```bash
   sed -e '/^$/d' -e 's/hello/HELLO/g' test.txt
   ```
5. **在指定行后追加内容**：在第3行后追加
   ```bash
   sed '3a =====' test.txt
   ```

### 五、sed 与 awk 的简单区别（避免混淆）
很多新手会把 `sed` 和另一个文本工具 `awk` 弄混，两者都是流处理工具，但定位不同：
- **sed**：核心是**行级别的字符串替换/删除/插入**，专注**文本修改**，适合简单的批量替换场景；
- **awk**：核心是**字段级别的数据处理**（按分隔符拆分列，如空格、逗号），专注**数据提取、统计、格式化**，适合处理表格、日志的列数据。

简单记：**改文本用 sed，取数据用 awk**。

### 总结
1. `sed` 是 Linux/Unix 的**流编辑器**，非交互式、行导向，主打文本的批量查找、替换、删除、插入；
2. 核心用法是**替换（s 命令）**，搭配 `-i` 原地修改文件、`g` 全局替换、正则表达式是高频组合；
3. 关键选项：`-n`（静默打印）、`-i`（原地修改）、`-E`（扩展正则）；
4. 与 `awk` 分工不同：sed 专注**文本修改**，awk 专注**数据提取统计**；
5. 优势是轻量、高效，无交互，完美适配 Shell 脚本自动化处理文本。

日常开发/运维中，`sed` 最常用的场景就是**批量修改配置文件**（如替换配置项、注释指定行）、**清洗日志**（删除空行、替换日志中的无用字符）、**脚本中的文本预处理**。