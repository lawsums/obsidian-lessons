/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var ke=Object.create;var V=Object.defineProperty;var Ce=Object.getOwnPropertyDescriptor;var De=Object.getOwnPropertyNames;var Ee=Object.getPrototypeOf,be=Object.prototype.hasOwnProperty;var Se=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports),xe=(t,n)=>{for(var e in n)V(t,e,{get:n[e],enumerable:!0})},ae=(t,n,e,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of De(n))!be.call(t,s)&&s!==e&&V(t,s,{get:()=>n[s],enumerable:!(r=Ce(n,s))||r.enumerable});return t};var Te=(t,n,e)=>(e=t!=null?ke(Ee(t)):{},ae(n||!t||!t.__esModule?V(e,"default",{value:t,enumerable:!0}):e,t)),Le=t=>ae(V({},"__esModule",{value:!0}),t);var ie=Se((Pe,j)=>{(function(t){if(typeof j=="object"&&typeof j.exports=="object")j.exports=t();else if(typeof define=="function"&&define.amd)define(t);else{let n=typeof globalThis=="undefined"?window:globalThis;n.CalendarHeatmap=t()}})(function(){var t=Math.max,n=Number.isNaN;function e(a){let i=((a||"en")+"").toLowerCase(),o=pe[i]||i;return A[o]||A.en}function r(a){if(!a)throw new Error("CalendarHeatmap: container is required.");if(typeof a=="string"){let i=document.querySelector(a);if(!i)throw new Error(`CalendarHeatmap: container selector "${a}" not found.`);return i}return a}function s(){if(typeof document!="undefined"&&!document.getElementById(Z)){let a=document.createElement("style");a.id=Z,a.textContent=[".ch-root { font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; --ch-size: 14px; --ch-gap: 2px; }",".ch-grid { display: grid; grid-auto-flow: column; grid-auto-columns: max-content; column-gap: var(--ch-gap); }",".ch-week { display: grid; grid-template-rows: repeat(7, 1fr); row-gap: var(--ch-gap); }",`.ch-day { width: var(--ch-size); height: var(--ch-size); box-sizing: border-box; border-radius: 2px; background-color: ${O[0]}; position: relative; }`,`.ch-day[data-level="0"] { background-color: ${O[0]}; }`,".ch-tooltip { position: absolute; pointer-events: none; z-index: 9999; padding: 4px 6px; border-radius: 4px; font-size: 12px; background: rgba(17, 24, 39, 0.9); color: #fff; }",".ch-legend { display: flex; align-items: center; gap: 4px; font-size: 12px; margin-top: 8px; color: #555; }",".ch-legend .ch-swatch { display: inline-block; width: var(--ch-size); height: var(--ch-size); border-radius: 2px; }",".ch-labels { display: grid; grid-template-rows: repeat(7, var(--ch-size)); row-gap: var(--ch-gap); margin-right: 6px; font-size: 10px; color: #555; }"].join(`
`),document.head.appendChild(a)}}function c(a){let i=a.getFullYear(),o=(a.getMonth()+1+"").padStart(2,"0"),l=(a.getDate()+"").padStart(2,"0");return`${i}-${o}-${l}`}function u(a){let i=new Map;return Array.isArray(a)&&a.forEach(o=>{if(!o)return;let l=new Date(o.date||o.day||o.dateString);if(n(l.getTime()))return;let d=c(l),h=typeof o.value=="number"?o.value:+o.count;n(h)||i.set(d,h)}),i}function y(a,i){let o=new Date(a);return o.setDate(a.getDate()+i),o}function p(a,i){let o=new Date(a),l=(o.getDay()-i+7)%7;return o.setDate(o.getDate()-l),o.setHours(0,0,0,0),o}function w(a,i){let o=p(a,i);return y(o,6)}function S(a,i){let o=i.weekStart%7,l,d;if(a==="year"){let m=+i.year;l=new Date(m,0,1),d=new Date(m,11,31)}else if(a==="month"){let m=+i.year,D=+i.month;l=new Date(m,D,1),d=new Date(m,D+1,0)}else if(a==="week"){let m=i.startDate?new Date(i.startDate):new Date;if(n(m.getTime()))throw new Error("CalendarHeatmap: invalid startDate for week view.");l=p(m,o),d=w(m,o)}else if(a==="recent"){let m=t(+i.recentDays||7,1);d=new Date,d.setHours(0,0,0,0),l=y(d,-m+1)}else throw new Error(`CalendarHeatmap: unsupported view "${a}".`);let h=p(l,o),g=w(d,o),f=[];for(let m=new Date(h);m<=g;)f.push(new Date(m)),m=y(m,1);return{start:l,end:d,alignedStart:h,alignedEnd:g,dates:f}}function x(a,i,o){var l=Math.round,d=Math.min,h=Number.isFinite;let g=Array.isArray(o)&&o.length?o:O;if(typeof o=="function"){let k=o(a,i);if(typeof k=="string")return{color:k,level:0<a?1:0};if(k&&typeof k=="object"){let T=+k.level,H=h(T)?t(0,d(T,g.length-1)):0<a?1:0;return{color:k.color||g[H]||g[0],level:k.level==null?0<a?1:0:H}}}if(!a||0>=i)return{color:g[0],level:0};let f=g.length-1;if(0>=f)return{color:g[0],level:0<a?1:0};let m=d(a/i,1),D=t(1,l(m*f));return{color:g[D],level:D}}function L(a,i,o){if(typeof document=="undefined")return null;let l=document.createElement("div");l.className="ch-labels";let d=Array.isArray(i.weekdays)&&i.weekdays.length===7?i.weekdays:null,h=d?null:new Intl.DateTimeFormat(o,{weekday:"short"});for(let g=0;7>g;g+=1){let f=(g+a.weekStart)%7,m=d?d[f]:h.format(new Date(2021,7,f+1)),D=document.createElement("span");D.textContent=m,l.appendChild(D)}return l}function F(a,i){if(typeof document=="undefined")return null;let o=Array.isArray(a)&&a.length?a:O,l=document.createElement("div");l.className="ch-legend";let d=document.createElement("span");d.textContent=i.less,l.appendChild(d),o.forEach(g=>{let f=document.createElement("span");f.className="ch-swatch",f.style.backgroundColor=g,l.appendChild(f)});let h=document.createElement("span");return h.textContent=i.more,l.appendChild(h),l}function X(a,i){if(typeof document=="undefined")return;let o=document.createElement("div");o.className="ch-tooltip",o.style.display="none",document.body.appendChild(o);let l=h=>{let g=h.target.closest(".ch-day");return g&&a.contains(g)?(o.innerHTML=i(g.dataset),o.style.display="block",o.style.left=`${h.pageX+10}px`,void(o.style.top=`${h.pageY+10}px`)):void(o.style.display="none")},d=()=>{o.style.display="none"};return a.addEventListener("mousemove",l),a.addEventListener("mouseleave",d),()=>{a.removeEventListener("mousemove",l),a.removeEventListener("mouseleave",d),o&&o.parentNode&&o.parentNode.removeChild(o),o=null}}function Q(a){let i=document.createElement("div");return i.className="ch-week",a.forEach(o=>{i.appendChild(o)}),i}function ge(a,i){if(typeof window!="undefined"){let o=()=>{let l=a.clientWidth||a.getBoundingClientRect().width||0;if(l)for(;i.scrollWidth>l-40&&1<i.children.length;){let d=i.firstElementChild;if(!d)break;i.removeChild(d)}};typeof window.requestAnimationFrame=="function"?window.requestAnimationFrame(o):o()}}let O=["#ebedf0","#9be9a8","#40c463","#30a14e","#216e39"],Z="calendar-heatmap-style",ee={view:"year",year:new Date().getFullYear(),month:new Date().getMonth(),weekStart:0,recentDays:7,squareSize:14,squareGap:2,colorScale:O,maxValue:null,legend:!1,tooltip:!0,locale:void 0,language:"en"},A={en:{locale:"en-US",legend:{less:"Less",more:"More"},weekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],tooltip:(a,i)=>`${a} on ${i}`},"zh-cn":{locale:"zh-CN",legend:{less:"\u8F83\u5C11",more:"\u8F83\u591A"},weekdays:["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],tooltip:(a,i)=>`${i}\uFF1A${a}`},"zh-tw":{locale:"zh-TW",legend:{less:"\u8F03\u5C11",more:"\u8F03\u591A"},weekdays:["\u9031\u65E5","\u9031\u4E00","\u9031\u4E8C","\u9031\u4E09","\u9031\u56DB","\u9031\u4E94","\u9031\u516D"],tooltip:(a,i)=>`${i}\uFF1A${a}`},ja:{locale:"ja-JP",legend:{less:"\u5C11\u306A\u3044",more:"\u591A\u3044"},weekdays:["\u65E5","\u6708","\u706B","\u6C34","\u6728","\u91D1","\u571F"],tooltip:(a,i)=>`${i}\uFF1A${a}`},fr:{locale:"fr-FR",legend:{less:"Moins",more:"Plus"},weekdays:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],tooltip:(a,i)=>`${a} le ${i}`},de:{locale:"de-DE",legend:{less:"Weniger",more:"Mehr"},weekdays:["So","Mo","Di","Mi","Do","Fr","Sa"],tooltip:(a,i)=>`${a} am ${i}`},ko:{locale:"ko-KR",legend:{less:"\uC801\uC74C",more:"\uB9CE\uC74C"},weekdays:["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"],tooltip:(a,i)=>`${i} ${a}`},es:{locale:"es-ES",legend:{less:"Menos",more:"M\xE1s"},weekdays:["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"],tooltip:(a,i)=>`${a} el ${i}`},it:{locale:"it-IT",legend:{less:"Meno",more:"Pi\xF9"},weekdays:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"],tooltip:(a,i)=>`${a} il ${i}`}},pe={en:"en","en-us":"en","en-gb":"en",english:"en",zh:"zh-cn","zh-cn":"zh-cn","zh-hans":"zh-cn","zh-sg":"zh-cn","zh-tw":"zh-tw","zh-hant":"zh-tw","zh-hk":"zh-tw",ja:"ja","ja-jp":"ja",japanese:"ja",fr:"fr","fr-fr":"fr",french:"fr",de:"de","de-de":"de",german:"de",ko:"ko","ko-kr":"ko",korean:"ko",es:"es","es-es":"es",spanish:"es",it:"it","it-it":"it",italian:"it"};class _{constructor(i,o=[],l={}){if(typeof document=="undefined")throw new Error("CalendarHeatmap: browser environment required.");this.container=r(i),this.options=Object.assign({},ee,l),this.data=u(o),this.tooltipDisposer=null,s(),this.render()}setOptions(i={}){this.options=Object.assign({},this.options,i),s(),this.render()}setData(i=[]){this.data=u(i),this.render()}replaceData(i=[]){this.setData(i)}render(){var i=Math.floor;let{dates:o,start:l,end:d}=S(this.options.view,this.options),h=e(this.options.language||this.options.locale),g=this.options.locale||h.locale||void 0,f;try{f=new Intl.DateTimeFormat(g,{dateStyle:"medium"})}catch(C){f=new Intl.DateTimeFormat(g,{month:"short",day:"numeric",year:"numeric"})}let m=Array.from(this.data.values()),D=this.options.maxValue==null?m.reduce((C,E)=>t(C,E),0):this.options.maxValue,k=document.createElement("div");k.className="ch-root",k.style.setProperty("--ch-size",`${this.options.squareSize}px`),k.style.setProperty("--ch-gap",`${this.options.squareGap}px`);let T=document.createElement("div");T.style.display="flex";let H=L(this.options,h,g);H&&T.appendChild(H);let N=document.createElement("div");N.className="ch-grid";let M=[],te=null,he=this.options.view==="year",me=new Date,ye=this.options.weekStart%7;for(let C=0;C<o.length;C+=1){let E=o[C],I=c(E);if(he&&I>c(me))break;let z=i(C/7);te!==z&&(M.length&&(N.appendChild(Q(M)),M=[]),te=z);let ne=this.data.get(I)||0,{color:ve,level:we}=x(ne,D,this.options.colorScale),fe=(E.getDay()-ye+7)%7,b=document.createElement("div");b.className="ch-day",b.style.backgroundColor=ve,b.dataset.level=we+"",b.dataset.value=ne+"",b.dataset.date=I,b.dataset.rangeStart=c(l),b.dataset.rangeEnd=c(d),b.title="",b.style.gridRowStart=fe+1+"",M.push(b)}if(M.length&&N.appendChild(Q(M)),T.appendChild(N),k.appendChild(T),this.options.view==="year"&&ge(this.container,N),this.options.legend){let C=Object.assign({},A.en.legend,h.legend),E=F(this.options.colorScale,C);E&&k.appendChild(E)}this.container.innerHTML="",this.container.appendChild(k),this.tooltipDisposer&&(this.tooltipDisposer(),this.tooltipDisposer=null),this.options.tooltip&&(this.tooltipDisposer=X(k,C=>{let E=+C.value||0,I=new Date(C.date),z=n(I.getTime())?C.date:f.format(I);return h.tooltip?h.tooltip(E,z):A.en.tooltip(E,z)}))}destroy(){this.tooltipDisposer&&(this.tooltipDisposer(),this.tooltipDisposer=null),this.container.innerHTML=""}}return _.defaults=Object.assign({},ee),_.languages=A,_})});var Ve={};xe(Ve,{default:()=>B});module.exports=Le(Ve);var v=require("obsidian"),ue=Te(ie());function re(t){let n=t.getFullYear(),e=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0");return`${n}-${e}-${r}`}function Me(t){let n=new Date(t);return isNaN(n.getTime())?null:n}function Ie(t){let n=t.match(/^\*\s+(\d{4}-\d{2}-\d{2})\s+-\s+(\d+)/);if(!n)return null;let e=Me(n[1]),r=parseInt(n[2],10);return!e||isNaN(r)?null:{date:e,value:r}}function $(t){let n=t.split(`
`),e=[];for(let r of n){let s=Ie(r);s&&e.push(s)}return e}function R(t){let n=re(new Date);return new RegExp(`^\\*\\s+${n}\\s+-`,"m").test(t)}function oe(t,n){let e=t.lastLine(),r=t.getLine(e).length,s=Oe(n);t.replaceRange(`
${s}`,{line:e,ch:r})}function Oe(t){return`* ${re(new Date)} - ${t}`}var P=t=>{let n=t instanceof Date?t:new Date(t);return Number.isNaN(n.getTime())?"":new Date(n.getTime()-n.getTimezoneOffset()*6e4).toISOString().slice(0,10)},Ae=t=>{let[n,e,r]=t.split("-").map(Number);return new Date(n,(e||1)-1,r||1)},K=t=>{let n=new Set,e=null;for(let p of t){let w=P(p.date);w&&(n.add(w),(!e||w<e)&&(e=w))}let r=P(new Date),s=n.size>0,c=n.has(r),u=0;if(s){let p=new Date;for(c||p.setDate(p.getDate()-1);n.has(P(p));)u+=1,p.setDate(p.getDate()-1)}let y=null;if(s&&e){let p=Ae(e),w=new Date;for(;w>=p;){let S=P(w);if(!n.has(S)){y=S;break}w.setDate(w.getDate()-1)}}return{hasEntries:s,hasToday:c,streak:u,lastMissing:y}},se=(t,n,e)=>{var c;t.empty(),t.addClass("easy-tracker-card"),t.setAttr("id","easy-tracker-daily-overview"),t.createEl("div",{cls:"easy-tracker-card-title",text:e("overview.title")});let r=[{label:e("overview.statusLabel"),value:n.hasToday?e("overview.statusValue.checkedIn"):e("overview.statusValue.missed"),hint:n.hasToday?e("overview.statusHint.checkedIn"):e("overview.statusHint.missed"),modifier:n.hasToday?"easy-tracker-daily-overview__value--positive":"easy-tracker-daily-overview__value--warning"},{label:e("overview.streakLabel"),value:e("overview.streakValue",{count:String(n.hasEntries?n.streak:0)}),hint:n.hasEntries&&n.streak>0?e("overview.streakHint.active"):e("overview.streakHint.inactive")},{label:e("overview.gapLabel"),value:n.hasEntries?(c=n.lastMissing)!=null?c:e("overview.gapValue.none"):e("overview.noData"),hint:n.lastMissing?e("overview.gapHint.present"):e("overview.gapHint.none")}],s=t.createDiv({cls:"easy-tracker-daily-overview__grid"});for(let u of r){let y=s.createDiv({cls:"easy-tracker-daily-overview__item"});y.createEl("div",{cls:"easy-tracker-daily-overview__label",text:u.label});let p=y.createEl("div",{cls:"easy-tracker-daily-overview__value",text:u.value});u.modifier&&p.addClass(u.modifier),u.hint&&y.createEl("div",{cls:"easy-tracker-daily-overview__hint",text:u.hint})}},q=(t,n,e)=>{let r=t.createDiv();se(r,n,e)},le=(t,n,e)=>{let r=t.querySelector("#easy-tracker-daily-overview");r instanceof HTMLElement?se(r,n,e):q(t,n,e)};var He={"notice.noActiveMarkdownView":"No active Markdown view","notice.alreadyCheckedIn":"Already checked in today","notice.editorUnavailable":"Editor instance not available","notice.onlyCheckInInEditMode":"Please switch to edit mode to check in.","notice.checkInTooFast":"You are checking in too frequently. Please wait a moment before trying again.","card.goalTitle":"My Goal","card.goalPlaceholder":"Define your goal here!","card.activityHistoryTitle":"Activity History","card.buttonsTitle":"How did you do today?","card.checkInCongrats":"Another day done, you're making progress! \u{1F389}","card.defaultButton":"Button","command.insertCalendarHeatmap":"Insert calendar heatmap","command.insertCheckInComponent":"Insert Check-in Component","command.insertSingleCheckInComponent":"Insert Single Check-in Component","command.insertDailyOverview":"Insert Daily Overview","command.insertMyGoal":"Insert My Goal","snippet.justABit":"Just a bit","snippet.gotItDone":"Got it done","snippet.didExtra":"Did extra","snippet.checkIn":"Check in","setting.weekStartName":"Week start","setting.weekStartDescription":"Choose the first day of the week used by the calendar","setting.weekStart.monday":"Monday","setting.weekStart.sunday":"Sunday","setting.languageName":"Language","setting.languageDescription":"Choose how the plugin language is determined","setting.languageOption.system":"Follow Obsidian language","setting.languageOption.en":"English","setting.languageOption.zhCN":"Simplified Chinese","overview.title":"Today's overview","overview.statusLabel":"Today's status","overview.statusValue.checkedIn":"Checked in","overview.statusValue.missed":"Missed","overview.statusHint.checkedIn":"Keep the pace","overview.statusHint.missed":"Remember to check in","overview.streakLabel":"Streak","overview.streakHint.active":"Keep it going","overview.streakHint.inactive":"Waiting to start","overview.gapLabel":"Most recent gap","overview.gapValue.none":"No gaps","overview.noData":"No data yet","overview.gapHint.present":"Review this day","overview.gapHint.none":"Looking steady","overview.streakValue":"{{count}} days"},Ne={"notice.noActiveMarkdownView":"\u6CA1\u6709\u6253\u5F00\u7684 Markdown \u89C6\u56FE","notice.alreadyCheckedIn":"\u4ECA\u5929\u5DF2\u7ECF\u6253\u5361\u4E86","notice.editorUnavailable":"\u65E0\u6CD5\u83B7\u53D6\u7F16\u8F91\u5668\u5B9E\u4F8B","notice.onlyCheckInInEditMode":"\u8BF7\u5207\u6362\u5230\u7F16\u8F91\u6A21\u5F0F\u4EE5\u8FDB\u884C\u6253\u5361\u3002","notice.checkInTooFast":"\u4F60\u6253\u5361\u5F97\u592A\u9891\u7E41\u4E86\uFF0C\u8BF7\u7A0D\u7B49\u7247\u523B\u518D\u8BD5\u3002","card.goalTitle":"\u6211\u7684\u76EE\u6807","card.goalPlaceholder":"\u5728\u8FD9\u91CC\u63CF\u8FF0\u4F60\u7684\u76EE\u6807\uFF01","card.activityHistoryTitle":"\u6D3B\u52A8\u8BB0\u5F55","card.buttonsTitle":"\u4ECA\u5929\u8868\u73B0\u5982\u4F55\uFF1F","card.checkInCongrats":"\u53C8\u575A\u6301\u4E86\u4E00\u5929\uFF0C\u4F60\u6B63\u5728\u4E0D\u65AD\u8FDB\u6B65\uFF01\u{1F389}","card.defaultButton":"\u6309\u94AE","command.insertCalendarHeatmap":"\u63D2\u5165\u65E5\u5386\u70ED\u529B\u56FE","command.insertCheckInComponent":"\u63D2\u5165\u6253\u5361\u7EC4\u4EF6","command.insertSingleCheckInComponent":"\u63D2\u5165\u5355\u6309\u94AE\u6253\u5361\u7EC4\u4EF6","command.insertDailyOverview":"\u63D2\u5165\u6BCF\u65E5\u6982\u89C8","command.insertMyGoal":"\u63D2\u5165\u76EE\u6807\u5361\u7247","snippet.justABit":"\u7A0D\u5FAE\u505A\u4E86\u4E00\u70B9","snippet.gotItDone":"\u987A\u5229\u5B8C\u6210","snippet.didExtra":"\u989D\u5916\u5B8C\u6210","snippet.checkIn":"\u6253\u5361","setting.weekStartName":"\u6BCF\u5468\u8D77\u59CB\u65E5","setting.weekStartDescription":"\u9009\u62E9\u70ED\u529B\u56FE\u4E2D\u7684\u6BCF\u5468\u8D77\u59CB\u65E5","setting.weekStart.monday":"\u5468\u4E00","setting.weekStart.sunday":"\u5468\u65E5","setting.languageName":"\u754C\u9762\u8BED\u8A00","setting.languageDescription":"\u9009\u62E9\u63D2\u4EF6\u8BED\u8A00\u7684\u6765\u6E90","setting.languageOption.system":"\u8DDF\u968F Obsidian \u8BED\u8A00","setting.languageOption.en":"\u82F1\u6587","setting.languageOption.zhCN":"\u7B80\u4F53\u4E2D\u6587","overview.title":"\u4ECA\u65E5\u6982\u89C8","overview.statusLabel":"\u4ECA\u65E5\u72B6\u6001","overview.statusValue.checkedIn":"\u5DF2\u6253\u5361","overview.statusValue.missed":"\u672A\u6253\u5361","overview.statusHint.checkedIn":"\u4FDD\u6301\u8282\u594F","overview.statusHint.missed":"\u522B\u5FD8\u4E86\u6253\u5361","overview.streakLabel":"\u8FDE\u7EED\u5929\u6570","overview.streakHint.active":"\u7EE7\u7EED\u4FDD\u6301","overview.streakHint.inactive":"\u7B49\u5F85\u5F00\u542F","overview.gapLabel":"\u6700\u8FD1\u4E00\u6B21\u4E2D\u65AD","overview.gapValue.none":"\u6682\u65E0\u4E2D\u65AD","overview.noData":"\u6682\u65E0\u6570\u636E","overview.gapHint.present":"\u56DE\u987E\u90A3\u4E00\u5929","overview.gapHint.none":"\u8868\u73B0\u7A33\u5B9A","overview.streakValue":"{{count}} \u5929"},G={en:He,"zh-CN":Ne},W="en",ze=/\{\{\s*(\w+)\s*\}\}/g,J=t=>(n,e)=>{var u,y,p;let r=(u=G[t])!=null?u:G[W],s=G[W],c=(p=(y=r[n])!=null?y:s[n])!=null?p:String(n);return e?c.replace(ze,(w,S)=>{if(Object.prototype.hasOwnProperty.call(e,S)){let x=e[S];return x==null?"":String(x)}return w}):c},$e=t=>t?t.toLowerCase().startsWith("zh")?"zh-CN":"en":W,ce=(t,n)=>t==="system"?$e(n):t,U=t=>t==="system"||t==="en"||t==="zh-CN";var B=class extends v.Plugin{constructor(){super(...arguments);this.heatmaps=[];this.overviewBlocks=[];this.locale="en";this.translator=J("en");this.lastCheckInTime=0}t(e,r){return this.translator(e,r)}getSystemLocale(){return(0,v.getLanguage)()}refreshLocale(){let e=ce(this.settings.language,this.getSystemLocale());this.locale=e,this.translator=J(e),this.updateOverviews()}async updateLanguage(e){this.settings.language=e,await this.saveSettings(),this.refreshLocale()}getActiveMarkdownView(){let e=this.app.workspace.getActiveViewOfType(v.MarkdownView);return e||(new v.Notice(this.t("notice.noActiveMarkdownView")),null)}getActiveContent(){let e=this.getActiveMarkdownView();return e&&e.editor.getValue()||""}isTodayCheckedIn(){let e=this.getActiveMarkdownView();if(!e)return!1;let r=e.editor.getValue()||"";return R(r)}insertEntry(e){let r=Date.now();if(r-this.lastCheckInTime<1e3)return new v.Notice(this.t("notice.checkInTooFast")),!1;this.lastCheckInTime=r;let s=this.getActiveMarkdownView();if(!s)return!1;if(s.getMode()!=="source")return new v.Notice(this.t("notice.onlyCheckInInEditMode")),!1;let c=s.editor.getValue()||"";if(R(c))return new v.Notice(this.t("notice.alreadyCheckedIn")),!1;let u=s.editor;return u?(oe(u,e),this.updateHeatmaps(),this.updateOverviews(),!0):(new v.Notice(this.t("notice.editorUnavailable")),!1)}parseHeatmapOptions(e){try{return e.trim()?JSON.parse(e):{}}catch(r){return console.warn("calendar-heatmap: unable to parse options JSON, using defaults"),{}}}updateHeatmaps(){let e=$(this.getActiveContent());this.heatmaps.forEach(r=>r.replaceData(e))}updateOverviews(){if(!this.overviewBlocks.length)return;let e=$(this.getActiveContent()),r=K(e);for(let s of this.overviewBlocks)le(s,r,this.translator)}async onload(){await this.loadSettings(),this.refreshLocale(),this.registerMarkdownCodeBlockProcessor("easy-tracker-my-goal",(e,r,s)=>{let c=r.createDiv({cls:"easy-tracker-card"});c.setAttr("id","easy-tracker-my-goal"),c.createEl("div",{cls:"easy-tracker-card-title",text:this.t("card.goalTitle")}),c.createEl("div",{cls:"easy-tracker-my-goal",text:e.trim()||this.t("card.goalPlaceholder")})}),this.registerMarkdownCodeBlockProcessor("easy-tracker-year-calendar-heatmap",(e,r,s)=>{let c=$(this.getActiveContent()),u=this.parseHeatmapOptions(e),y=r.createDiv({cls:"easy-tracker-card"});y.createEl("div",{cls:"easy-tracker-card-title",text:this.t("card.activityHistoryTitle")});let p=y.createDiv({cls:"easy-tracker-year-calendar-heatmap"}),w=new ue.default(p,c,{weekStart:this.settings.weekStart,view:"year",year:new Date().getFullYear(),legend:!1,language:this.locale,...u});this.heatmaps.push(w)}),this.registerMarkdownCodeBlockProcessor("easy-tracker-buttons",(e,r)=>{let s=r.createDiv({cls:"easy-tracker-card"});if(s.setAttr("id","easy-tracker-buttons"),s.createEl("div",{cls:"easy-tracker-card-title",text:this.t("card.buttonsTitle")}),this.isTodayCheckedIn()){s.createEl("div",{cls:"easy-tracker-card-message",text:this.t("card.checkInCongrats")});return}let c=s.createDiv({cls:"easy-tracker-button-group"}),u=e.split(`
`).map(y=>y.trim()).filter(Boolean);for(let[y,p]of u.entries()){let[w,S]=p.split("|").map(L=>L.trim()),x=new v.ButtonComponent(c);x.buttonEl.addClass("btn"),x.setButtonText(w||this.t("card.defaultButton")),x.onClick(()=>{let L=Number(S),F=Number.isFinite(L)?L:y+1;this.insertEntry(F)&&(c.setCssStyles({display:"none"}),s.createEl("div",{cls:"easy-tracker-card-message",text:this.t("card.checkInCongrats")}))})}}),this.registerMarkdownCodeBlockProcessor("easy-tracker-daily-overview",(e,r)=>{let s=$(this.getActiveContent()),c=K(s);q(r,c,this.translator),this.overviewBlocks.push(r)}),this.addCommand({id:"insert-calendar-heatmap",name:this.t("command.insertCalendarHeatmap"),editorCallback:(e,r)=>{e.replaceSelection(["```easy-tracker-year-calendar-heatmap","```",""].join(`
`))}}),this.addCommand({id:"insert-check-in-component",name:this.t("command.insertCheckInComponent"),editorCallback:(e,r)=>{e.replaceSelection(["```easy-tracker-daily-overview","```","```easy-tracker-year-calendar-heatmap","```","```easy-tracker-buttons",`  ${this.t("snippet.justABit")} | 1`,`  ${this.t("snippet.gotItDone")} | 2`,`  ${this.t("snippet.didExtra")} | 3`,"```","```easy-tracker-my-goal",this.t("card.goalPlaceholder"),"```",""].join(`
`))}}),this.addCommand({id:"insert-single-check-in-component",name:this.t("command.insertSingleCheckInComponent"),editorCallback:(e,r)=>{e.replaceSelection(["```easy-tracker-daily-overview","```","```easy-tracker-year-calendar-heatmap","```","```easy-tracker-buttons",`  ${this.t("snippet.checkIn")} | 1`,"```","```easy-tracker-my-goal",this.t("card.goalPlaceholder"),"```",""].join(`
`))}}),this.addCommand({id:"insert-daily-overview",name:this.t("command.insertDailyOverview"),editorCallback:(e,r)=>{e.replaceSelection(["```easy-tracker-daily-overview","```",""].join(`
`))}}),this.addCommand({id:"insert-my-goal",name:this.t("command.insertMyGoal"),editorCallback:(e,r)=>{e.replaceSelection(["```easy-tracker-easy-tracker-my-goal",this.t("card.goalPlaceholder"),"```",""].join(`
`))}}),this.addSettingTab(new Y(this.app,this))}onunload(){}async loadSettings(){let e=await this.loadData(),r=e==null?void 0:e.weakStart,s=typeof r!="undefined"?parseInt(String(r))===0?0:1:void 0,c=U(e==null?void 0:e.language)?e.language:de.language,u={};typeof(e==null?void 0:e.weekStart)=="number"&&(u.weekStart=e.weekStart===0?0:1),typeof s!="undefined"&&(u.weekStart=s),this.settings={...de,...u,language:c}}async saveSettings(){await this.saveData(this.settings)}},de={weekStart:1,language:"system"},Y=class extends v.PluginSettingTab{constructor(e,r){super(e,r);this.plugin=r}display(){let{containerEl:e}=this;e.empty(),new v.Setting(e).setName(this.plugin.t("setting.languageName")).setDesc(this.plugin.t("setting.languageDescription")).addDropdown(r=>{r.addOption("system",this.plugin.t("setting.languageOption.system")),r.addOption("en",this.plugin.t("setting.languageOption.en")),r.addOption("zh-CN",this.plugin.t("setting.languageOption.zhCN")),r.setValue(this.plugin.settings.language),r.onChange(async s=>{let c=U(s)?s:"system";await this.plugin.updateLanguage(c),this.display()})}),new v.Setting(e).setName(this.plugin.t("setting.weekStartName")).setDesc(this.plugin.t("setting.weekStartDescription")).addDropdown(r=>{r.addOption("1",this.plugin.t("setting.weekStart.monday")),r.addOption("0",this.plugin.t("setting.weekStart.sunday")),r.setValue(String(this.plugin.settings.weekStart)),r.onChange(async s=>{this.plugin.settings.weekStart=s==="0"?0:1,await this.plugin.saveSettings()})})}};
