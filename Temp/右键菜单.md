
在 Windows 注册表中，不同的右键菜单对应不同的注册表位置。以下是详细的对应关系：

## 1. **文件夹上的右键菜单**
```
HKEY_CLASSES_ROOT\Directory\shell\
HKEY_CLASSES_ROOT\Directory\Background\shell\  (文件夹空白处右键)
```

- **`Directory\shell`** - 在文件夹图标上右键
- **`Directory\Background\shell`** - 在文件夹内部空白处右键

## 2. **文件上的右键菜单**
文件右键菜单基于文件扩展名：

### 所有文件通用菜单：
```
HKEY_CLASSES_ROOT\*\shell\
```

### 特定类型文件（以 .txt 为例）：
1. 先找到 .txt 关联的 ProgID
   ```
   HKEY_CLASSES_ROOT\.txt
   ```
   查看默认值，比如可能是 `txtfile`

2. 然后在该 ProgID 下：
   ```
   HKEY_CLASSES_ROOT\txtfile\shell\
   ```

### 直接扩展名菜单：
```
HKEY_CLASSES_ROOT\.txt\shell\  (这会影响所有 .txt 文件)
```

## 3. **桌面空白处的右键菜单**
```
HKEY_CLASSES_ROOT\DesktopBackground\shell\
```

## 完整路径对照表：

| 右键位置 | 主要注册表路径 | 说明 |
|---------|--------------|------|
| **文件夹图标** | `HKEY_CLASSES_ROOT\Directory\shell\` | 直接在文件夹图标上右键 |
| **文件夹内部空白处** | `HKEY_CLASSES_ROOT\Directory\Background\shell\` | 文件夹内空白区域右键 |
| **所有文件** | `HKEY_CLASSES_ROOT\*\shell\` | 任何类型文件上右键 |
| **特定文件类型** | `HKEY_CLASSES_ROOT\<ProgID>\shell\` | 如 `txtfile\shell\` |
| **桌面图标** | `HKEY_CLASSES_ROOT\Directory\shell\` | 同文件夹图标 |
| **桌面空白处** | `HKEY_CLASSES_ROOT\DesktopBackground\shell\` | 桌面空白区域右键 |
| **磁盘根目录** | `HKEY_CLASSES_ROOT\Drive\shell\` | C:、D: 等磁盘图标右键 |
| **磁盘内空白处** | `HKEY_CLASSES_ROOT\Drive\Background\shell\` | 磁盘内空白处右键 |
| **开始按钮** | `HKEY_CLASSES_ROOT\Directory\shell\` 和系统特定位置 | 比较复杂，有系统保护 |

## 实际示例 - 添加一个 "用记事本打开" 到所有文件：
```reg
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\*\shell\用记事本打开]
"Icon"="notepad.exe"

[HKEY_CLASSES_ROOT\*\shell\用记事本打开\command]
@="notepad.exe \"%1\""
```

## 重要说明：

1. **注册表编辑器位置**：按 `Win + R` 输入 `regedit` 打开
2. **修改前备份**：修改注册表前建议先导出备份
3. **管理员权限**：修改某些注册表项需要管理员权限
4. **刷新生效**：修改后可能需要重启或重启资源管理器才能生效
   - 重启资源管理器：任务管理器 → 找到 "Windows 资源管理器" → 右键重启
5. **用户级别**：用户级别的设置在 `HKEY_CURRENT_USER\Software\Classes\` 下有对应的位置

## 特殊位置：
- **发送到菜单**：`HKEY_CLASSES_ROOT\AllFilesystemObjects\shellex\ContextMenuHandlers\`
- **固定到快速访问**：`HKEY_CLASSES_ROOT\Folder\shellex\ContextMenuHandlers\`

**注意**：修改注册表有风险，建议先备份相关键值，或创建系统还原点。