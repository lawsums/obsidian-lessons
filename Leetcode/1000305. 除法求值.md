---
Date: 2026-01-30
Link: https://leetcode.com/problems/vlzXQL/
Category: 
- æ·±åº¦ä¼˜å…ˆæœç´¢
- å¹¿åº¦ä¼˜å…ˆæœç´¢
- å¹¶æŸ¥é›†
- å›¾
- æ•°ç»„
- æœ€çŸ­è·¯
Difficulty: Medium
SimilarQuestions:  
Completed: false
---

#æ·±åº¦ä¼˜å…ˆæœç´¢ #å¹¿åº¦ä¼˜å…ˆæœç´¢ #å¹¶æŸ¥é›† #å›¾ #æ•°ç»„ #æœ€çŸ­è·¯ 
```button
name <font color="#548dd4">æ‰“å¼€nvimï¼ˆè‡ªåŠ¨åˆ›å»º.cppï¼‰</font>
type link
action file:///E%3A%5CDocuments%5CObsidian_%5CCpp%5CLeetcode%5C1000305.%20%E9%99%A4%E6%B3%95%E6%B1%82%E5%80%BC.cpp
```
```button
name <font color="#6aa84f">åˆ·æ–°Solutionä»£ç </font>
type link
action obsidian://advanced-uri?command=templater%3Aexecute-script&script=%0A%20%20(async%20(tp)%20%3D%3E%20%7B%0A%20%20%20%20const%20fs%20%3D%20require('fs')%3B%0A%20%20%20%20const%20path%20%3D%20require('path')%3B%0A%20%20%20%20const%20targetFile%20%3D%20tp.config.target_file%3B%0A%20%20%20%20const%20cppFilePath%20%3D%20path.join(%0A%20%20%20%20%20%20targetFile.vault.adapter.basePath%2C%0A%20%20%20%20%20%20targetFile.parent.path%2C%0A%20%20%20%20%20%20%60%24%7BtargetFile.basename%7D.cpp%60%0A%20%20%20%20)%3B%0A%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%2F%2F%20%E8%AF%BB%E5%8F%96%E7%AC%94%E8%AE%B0%E5%86%85%E5%AE%B9%E5%92%8C%20cpp%20%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%0A%20%20%20%20%20%20const%20noteContent%20%3D%20await%20tp.file.content()%3B%0A%20%20%20%20%20%20let%20cppContent%20%3D%20fs.readFileSync(cppFilePath%2C%20'utf-8').trim()%20%7C%7C%20%22%2F%2F%20%E6%9A%82%E6%97%A0%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0%22%3B%0A%0A%20%20%20%20%20%20%2F%2F%20%E6%9B%BF%E6%8D%A2%20Solution%20%E9%83%A8%E5%88%86%E5%86%85%E5%AE%B9%0A%20%20%20%20%20%20const%20updatedContent%20%3D%20noteContent.replace(%0A%20%20%20%20%20%20%20%20%2F(%23%23%20Solution%5Cn%5Cn)(%5B%5Cs%5CS%5D*%3F)(%3F%3D%5CnEND)%2F%2C%0A%20%20%20%20%20%20%20%20(match%2C%20solutionTitle)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20return%20%60%24%7BsolutionTitle%7D%60%60cpp%0A%24%7BcppContent%7D%0A%60%60%60%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20)%3B%0A%0A%0A%20%20%20%20%20%20await%20tp.file.modify(updatedContent)%3B%0A%20%20%20%20%20%20new%20Notice(%22%E2%9C%85%20Solution%20%E5%88%B7%E6%96%B0%E6%88%90%E5%8A%9F%EF%BC%81%22)%3B%0A%20%20%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20%20%20console.error(%22%E5%88%B7%E6%96%B0%E5%A4%B1%E8%B4%A5%EF%BC%9A%22%2C%20error)%3B%0A%20%20%20%20%20%20new%20Notice(%60%E2%9D%8C%20%E5%88%B7%E6%96%B0%E5%A4%B1%E8%B4%A5%EF%BC%9A%24%7Berror.message%7D%60)%3B%0A%20%20%20%20%7D%0A%20%20%7D)(tp)%3B%20%2F%2F%20%E4%BC%A0%E9%80%92%20tp%20%E5%AF%B9%E8%B1%A1%E5%88%B0%E8%84%9A%E6%9C%AC%E4%B8%AD%0A
```

`button-anki-open`   `button-anki-update`

DECK: é¢è¯•é¢˜-hot100

## 1000305. é™¤æ³•æ±‚å€¼

ç»™å®šä¸€ä¸ªå˜é‡å¯¹æ•°ç»„ `equations` å’Œä¸€ä¸ªå®æ•°å€¼æ•°ç»„ `values` ä½œä¸ºå·²çŸ¥æ¡ä»¶ï¼Œå…¶ä¸­ `equations[i] = [Ai, Bi]` å’Œ `values[i]` å…±åŒè¡¨ç¤ºç­‰å¼ `Ai / Bi = values[i]` ã€‚æ¯ä¸ª `Ai` æˆ– `Bi` æ˜¯ä¸€ä¸ªè¡¨ç¤ºå•ä¸ªå˜é‡çš„å­—ç¬¦ä¸²ã€‚

å¦æœ‰ä¸€äº›ä»¥æ•°ç»„ `queries` è¡¨ç¤ºçš„é—®é¢˜ï¼Œå…¶ä¸­ `queries[j] = [Cj, Dj]` è¡¨ç¤ºç¬¬ `j` ä¸ªé—®é¢˜ï¼Œè¯·ä½ æ ¹æ®å·²çŸ¥æ¡ä»¶æ‰¾å‡º `Cj / Dj = ?` çš„ç»“æœä½œä¸ºç­”æ¡ˆã€‚

è¿”å› **æ‰€æœ‰é—®é¢˜çš„ç­”æ¡ˆ** ã€‚å¦‚æœå­˜åœ¨æŸä¸ªæ— æ³•ç¡®å®šçš„ç­”æ¡ˆï¼Œåˆ™ç”¨ `-1.0` æ›¿ä»£è¿™ä¸ªç­”æ¡ˆã€‚å¦‚æœé—®é¢˜ä¸­å‡ºç°äº†ç»™å®šçš„å·²çŸ¥æ¡ä»¶ä¸­æ²¡æœ‰å‡ºç°çš„å­—ç¬¦ä¸²ï¼Œä¹Ÿéœ€è¦ç”¨ `-1.0` æ›¿ä»£è¿™ä¸ªç­”æ¡ˆã€‚

**æ³¨æ„ï¼š**è¾“å…¥æ€»æ˜¯æœ‰æ•ˆçš„ã€‚å¯ä»¥å‡è®¾é™¤æ³•è¿ç®—ä¸­ä¸ä¼šå‡ºç°é™¤æ•°ä¸º 0 çš„æƒ…å†µï¼Œä¸”ä¸å­˜åœ¨ä»»ä½•çŸ›ç›¾çš„ç»“æœã€‚

**ç¤ºä¾‹ 1ï¼š**

**è¾“å…¥ï¼š**equations = [["a","b"],["b","c"]], values = [2.0,3.0], queries = [["a","c"],["b","a"],["a","e"],["a","a"],["x","x"]]
**è¾“å‡ºï¼š**[6.00000,0.50000,-1.00000,1.00000,-1.00000]
**è§£é‡Šï¼š**
æ¡ä»¶ï¼š_a / b = 2.0_, _b / c = 3.0_
é—®é¢˜ï¼š_a / c = ?_, _b / a = ?_, _a / e = ?_, _a / a = ?_, _x / x = ?_
ç»“æœï¼š[6.0, 0.5, -1.0, 1.0, -1.0 ]

**ç¤ºä¾‹ 2ï¼š**

**è¾“å…¥ï¼š**equations = [["a","b"],["b","c"],["bc","cd"]], values = [1.5,2.5,5.0], queries = [["a","c"],["c","b"],["bc","cd"],["cd","bc"]]
**è¾“å‡ºï¼š**[3.75000,0.40000,5.00000,0.20000]

**ç¤ºä¾‹ 3ï¼š**

**è¾“å…¥ï¼š**equations = [["a","b"]], values = [0.5], queries = [["a","b"],["b","a"],["a","c"],["x","y"]]
**è¾“å‡ºï¼š**[0.50000,2.00000,-1.00000,-1.00000]

**æç¤ºï¼š**

- `1 <= equations.length <= 20`
- `equations[i].length == 2`
- `1 <= Ai.length, Bi.length <= 5`
- `values.length == equations.length`
- `0.0 < values[i] <= 20.0`
- `1 <= queries.length <= 20`
- `queries[i].length == 2`
- `1 <= Cj.length, Dj.length <= 5`
- `Ai, Bi, Cj, Dj` ç”±å°å†™è‹±æ–‡å­—æ¯ä¸æ•°å­—ç»„æˆ

æ³¨æ„ï¼šæœ¬é¢˜ä¸ä¸»ç«™ 399Â é¢˜ç›¸åŒï¼šÂ [https://leetcode.cn/problems/evaluate-division/](https://leetcode.cn/problems/evaluate-division/)

## Notes
è¿™é¢˜ä¹Ÿæ˜¯ç»å…¸çš„ Floyd ç®—æ³• (è™½ç„¶æˆ‘å¥½åƒä¹Ÿæ²¡å­¦ä¼šå¤šä¹…ğŸ˜„)
æ³¨æ„ç‚¹:
1. éœ€è¦åå‘åŠ å…¥å€’æ•°çš„è¾¹
2. Double éœ€è¦æ³¨æ„ eps è¯¯å·®
3. ä½¿ç”¨ Floyd ç®—æ³•æ—¶ä½¿ç”¨ `graph[i][j] = graph[i][k] * graph[k][j]` è¡”æ¥, **å¤–å±‚å¾ªç¯ k**
## Solution 

![[1000305. é™¤æ³•æ±‚å€¼.cpp]]
```cpp  
#include <bits/stdc++.h>
using namespace std;


class Solution {
public:
    vector<double> calcEquation(vector<vector<string>>& equations, vector<double>& values, vector<vector<string>>& queries) {
        const double eps = 1e-9; // å®šä¹‰ä¸€ä¸ªè¯¯å·®å€¼, å°äºè¿™ä¸ªå€¼å°±ä¸ç”¨å¤„ç†
        int nvars = 0; // æœ‰å¤šå°‘ä¸ªå˜é‡
        unordered_map<string, int> variables; // é€šè¿‡ä½¿ç”¨å“ˆå¸Œè¡¨å‡å°‘æ—¶é—´å¤æ‚åº¦

        int n = equations.size();
        // ç»Ÿè®¡æœ‰å¤šå°‘ä¸ªå˜é‡
        for (int i = 0; i < n; i++) { 
            if (variables.find(equations[i][0]) == variables.end()) {
                variables[equations[i][0]] = nvars++;
            }
            if (variables.find(equations[i][1]) == variables.end()) {
                variables[equations[i][1]] = nvars++;
            }
        }

        // å»ºå›¾
        vector<vector<double>> graph(nvars, vector<double>(nvars, -1.0)); // ç”±äºæ˜¯éœ€è¦ä½¿ç”¨Floyd, æ‰€ä»¥ä¸ç”¨é‚»æ¥è¡¨è€Œæ˜¯é‚»æ¥çŸ©é˜µ 
                                                                          // 1 <= equations.length <= 20
                                                                          
        // å…³é”®ä¿®æ”¹ï¼šåˆå§‹åŒ–å¯¹è§’çº¿ï¼Œgraph[i][i] = 1.0ï¼ˆè‡ªèº«é™¤ä»¥è‡ªèº«ç­‰äº1ï¼‰
        for (int i = 0; i < nvars; i++) {
            graph[i][i] = 1.0;
        }
        for (int i = 0; i < n; i++) {
            int va = variables[equations[i][0]], vb = variables[equations[i][1]];
            graph[va][vb] = values[i];
            graph[vb][va] = 1.0 / values[i]; // åå‘åŠ å…¥è¾¹
        }

        // Floydå¯åŠ¨!
        for (int k = 0; k < nvars; k++) {
            for (int i = 0; i < nvars; i++) {
                for (int j = 0; j < nvars; j++) {
                    if (graph[i][k] > eps && graph[k][j] > eps) {
                        graph[i][j] = (graph[i][k] * graph[k][j]);
                    }
                }
            }
        }

        // é€šè¿‡å“ˆå¸Œè¡¨å¿«é€ŸæŸ¥æ‰¾ä¸¤ä¸ªå˜é‡çš„å€¼, å¦‚æœä»»æ„ä¸€ä¸ªä¸å­˜åœ¨å°±ç›´æ¥å†™å…¥-1, å¦åˆ™å†™å…¥æ­£ç¡®ç­”æ¡ˆ
        vector<double> ret;
        for (const auto& q: queries) {
            double result = -1.0;
            if (variables.find(q[0]) != variables.end() && variables.find(q[1]) != variables.end()) {
                int ia = variables[q[0]], ib = variables[q[1]];
                if (graph[ia][ib] > 0) {
                    result = graph[ia][ib];
                }
            }
            ret.push_back(result);
        }
        return ret;
    }
};
```  
END
<!--ID: 1769999093933-->
 
